# ==============================================================================
# BOXMOT Tracking Configuration Example for OTVision
# ==============================================================================
#
# This is a complete configuration example showing all BOXMOT tracking options.
# Copy this file to user_config.otvision.yaml and customize for your use case.
#
# Documentation: BOXMOT_INTEGRATION.md
# Installation: ./scripts/install_boxmot.sh (Linux/macOS)
#               scripts\install_boxmot.cmd  (Windows)
#
# ==============================================================================

---
# ==============================================================================
# LOGGING CONFIGURATION
# ==============================================================================
LOG:
  LOG_LEVEL_CONSOLE: INFO       # Logging level for console output
  LOG_LEVEL_FILE: DEBUG         # Logging level for file output

# ==============================================================================
# DETECTION CONFIGURATION
# ==============================================================================
DETECT:
  PATHS: []                     # List of video files or directories to process
  HALF_PRECISION: false         # Use FP16 for faster GPU inference
  OVERWRITE: true               # Overwrite existing detection files

  # YOLO model configuration
  YOLO:
    WEIGHTS: yolov8s            # Model: yolov8n, yolov8s, yolov8m, yolov8l, yolov8x
    CONF: 0.25                  # Minimum detection confidence threshold
    IOU: 0.45                   # NMS IoU threshold
    IMGSIZE: 640                # Input image size

# ==============================================================================
# TRACKING CONFIGURATION
# ==============================================================================
TRACK:
  PATHS: []                     # List of .otdet files to process
  OVERWRITE: true               # Overwrite existing tracking files

  # --------------------------------------------------------------------------
  # IOU Tracker Configuration (used when BOXMOT is disabled)
  # --------------------------------------------------------------------------
  # The IOU tracker is a simple, fast tracker based on intersection-over-union
  # matching. It's the default tracker and requires no additional dependencies.
  IOU:
    SIGMA_L: 0.0                # Low confidence threshold
    SIGMA_H: 0.5                # High confidence threshold
    SIGMA_IOU: 0.5              # IOU threshold for matching
    T_MIN: 3                    # Minimum track length (frames)
    T_MISS_MAX: 5               # Maximum frames a track can be missing

  # --------------------------------------------------------------------------
  # BOXMOT Tracker Configuration
  # --------------------------------------------------------------------------
  # BOXMOT provides state-of-the-art multi-object tracking algorithms.
  # Install with: uv pip install -e .[tracking_boxmot]
  BOXMOT:
    # Enable/disable BOXMOT tracking
    # When false, the IOU tracker above will be used
    ENABLED: true

    # Tracker algorithm to use
    # Motion-only trackers (fast, no ReID weights needed):
    #   - "bytetrack"  : Recommended for CPU, very fast (~1265 FPS on MOT17)
    #   - "ocsort"     : Alternative motion-only tracker (~1483 FPS on MOT17)
    #
    # Appearance-based trackers (higher accuracy, requires REID_WEIGHTS):
    #   - "botsort"    : Best overall accuracy (HOTA: 69.418)
    #   - "boosttrack" : Highest identity consistency (IDF1: 83.205)
    #   - "strongsort" : Balanced performance
    #   - "deepocsort" : Enhanced OcSORT with ReID
    #   - "hybridsort" : Hybrid motion-appearance approach
    TRACKER_TYPE: "bytetrack"

    # Compute device for tracking
    # Options:
    #   - "cpu"    : CPU processing (default, works everywhere)
    #   - "cuda:0" : First GPU
    #   - "cuda:1" : Second GPU
    #   - etc.
    DEVICE: "cpu"

    # Use FP16 half-precision for faster GPU inference
    # Only effective when using a GPU device
    # Set to true for ~2x speedup on compatible GPUs
    HALF_PRECISION: false

    # Path to ReID (Re-Identification) model weights
    # Required for appearance-based trackers (botsort, boosttrack, etc.)
    # Not needed for motion-only trackers (bytetrack, ocsort)
    #
    # Download weights:
    #   ./scripts/install_boxmot.sh --with-reid
    #
    # Or manually download from:
    #   https://github.com/mikel-brostrom/yolo_tracking/releases
    #
    # Common ReID models:
    #   - osnet_x0_25_msmt17.pt  : Lightweight, fast
    #   - osnet_x1_0_msmt17.pt   : Larger, more accurate
    #   - clip_market1501.pt     : CLIP-based ReID
    #
    # Example: REID_WEIGHTS: "/path/to/weights/osnet_x0_25_msmt17.pt"
    REID_WEIGHTS: null

    # Tracker-specific parameters (optional)
    # These are passed directly to the BOXMOT tracker and override defaults.
    # If frame_rate is not set, it's auto-detected from OTDET metadata.
    # See BOXMOT_INTEGRATION.md for full parameter reference.
    TRACKER_PARAMS:
      # frame_rate: 30      # Auto-detected if omitted
      track_buffer: 30      # Buffer size for track persistence


# ==============================================================================
# CONFIGURATION EXAMPLES
# ==============================================================================
# Below are example configurations for common use cases.
# Copy the relevant BOXMOT section to replace the one above.
#
# ------------------------------------------------------------------------------
# Example 1: Fast CPU Tracking (ByteTrack)
# Best for: Quick processing, CPU-only systems, real-time applications
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "bytetrack"
#     DEVICE: "cpu"
#     HALF_PRECISION: false
#     REID_WEIGHTS: null
#
# ------------------------------------------------------------------------------
# Example 2: GPU Tracking with FP16 (ByteTrack)
# Best for: Fast GPU processing, moderate accuracy
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "bytetrack"
#     DEVICE: "cuda:0"
#     HALF_PRECISION: true
#     REID_WEIGHTS: null
#
# ------------------------------------------------------------------------------
# Example 3: High Accuracy Tracking (BotSORT with ReID)
# Best for: Research, evaluation, occlusion-heavy scenes
# Requires: ReID weights downloaded
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "botsort"
#     DEVICE: "cuda:0"
#     HALF_PRECISION: true
#     REID_WEIGHTS: "/path/to/weights/osnet_x0_25_msmt17.pt"
#
# ------------------------------------------------------------------------------
# Example 4: Best Identity Consistency (BoostTrack)
# Best for: Long-term tracking, re-identification scenarios
# Requires: ReID weights downloaded
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "boosttrack"
#     DEVICE: "cuda:0"
#     HALF_PRECISION: true
#     REID_WEIGHTS: "/path/to/weights/osnet_x0_25_msmt17.pt"
#
# ------------------------------------------------------------------------------
# Example 5: Alternative Motion-Only (OcSORT)
# Best for: When ByteTrack doesn't perform well on specific data
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "ocsort"
#     DEVICE: "cpu"
#     HALF_PRECISION: false
#     REID_WEIGHTS: null
#
# ------------------------------------------------------------------------------
# Example 6: Disable BOXMOT (Use IOU Tracker)
# Best for: Simple scenarios, backward compatibility
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: false
#
# ------------------------------------------------------------------------------
# Example 7: ByteTrack with Custom Parameters
# Best for: Fine-tuning motion-only tracking
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "bytetrack"
#     DEVICE: "cpu"
#     HALF_PRECISION: false
#     REID_WEIGHTS: null
#     TRACKER_PARAMS:
#       track_thresh: 0.5      # Higher threshold for first-pass association
#       match_thresh: 0.85     # Stricter IoU matching
#       track_buffer: 60       # Longer track persistence
#       min_conf: 0.15         # Slightly higher minimum confidence
#
# ------------------------------------------------------------------------------
# Example 8: BotSORT with Custom Appearance Settings
# Best for: Optimizing appearance-based tracking
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "botsort"
#     DEVICE: "cuda:0"
#     HALF_PRECISION: true
#     REID_WEIGHTS: "/path/to/weights/osnet_x0_25_msmt17.pt"
#     TRACKER_PARAMS:
#       track_high_thresh: 0.6      # Higher confidence for first association
#       track_low_thresh: 0.1       # Low confidence for second association
#       proximity_thresh: 0.4       # Stricter spatial gating
#       appearance_thresh: 0.3      # Stricter appearance matching
#       cmc_method: "orb"           # Faster CMC than ECC
#       track_buffer: 40            # Extended track buffer
#
# ------------------------------------------------------------------------------
# Example 9: BoostTrack with Tuned Cost Weights
# Best for: Maximum identity consistency
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "boosttrack"
#     DEVICE: "cuda:0"
#     HALF_PRECISION: true
#     REID_WEIGHTS: "/path/to/weights/osnet_x0_25_msmt17.pt"
#     TRACKER_PARAMS:
#       lambda_iou: 0.6             # Higher IoU weight
#       lambda_mhd: 0.2             # Lower Mahalanobis weight
#       lambda_shape: 0.2           # Lower shape weight
#       dlo_boost_coef: 0.7         # Stronger DLO boosting
#       use_ecc: true               # Enable camera motion compensation
#
# ------------------------------------------------------------------------------
# Example 10: StrongSort for Dense Scenes
# Best for: Crowded scenes with many overlapping objects
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "strongsort"
#     DEVICE: "cuda:0"
#     HALF_PRECISION: true
#     REID_WEIGHTS: "/path/to/weights/osnet_x0_25_msmt17.pt"
#     TRACKER_PARAMS:
#       max_cos_dist: 0.15          # Stricter ReID matching
#       max_iou_dist: 0.6           # Stricter IoU matching
#       nn_budget: 150              # Larger appearance gallery
#       n_init: 5                   # More frames to confirm track
#       mc_lambda: 0.95             # Higher motion cost weight
#
# ------------------------------------------------------------------------------
# Example 11: OcSort with Custom Motion Settings
# Best for: Scenes with frequent occlusions
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "ocsort"
#     DEVICE: "cpu"
#     HALF_PRECISION: false
#     REID_WEIGHTS: null
#     TRACKER_PARAMS:
#       delta_t: 5                  # Longer time delta for velocity
#       inertia: 0.3                # Higher inertia for smoother motion
#       use_byte: true              # Enable ByteTrack-style association
#       Q_xy_scaling: 0.02          # Slightly higher position noise
#
# ------------------------------------------------------------------------------
# Example 12: HybridSort for Long-Term Tracking
# Best for: Re-identification after long occlusions
# ------------------------------------------------------------------------------
#   BOXMOT:
#     ENABLED: true
#     TRACKER_TYPE: "hybridsort"
#     DEVICE: "cuda:0"
#     HALF_PRECISION: true
#     REID_WEIGHTS: "/path/to/weights/osnet_x0_25_msmt17.pt"
#     TRACKER_PARAMS:
#       longterm_bank_length: 50    # Larger long-term appearance gallery
#       alpha: 0.85                 # Slightly faster appearance update
#       delta_t: 3                  # Standard velocity estimation
#       inertia: 0.05               # Low inertia for quick adaptation
